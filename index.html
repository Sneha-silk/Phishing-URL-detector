<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Phishing URL Detector</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <div class="wrap">
    <header class="hero">
      <div class="icon">üõ°Ô∏è</div>
      <h1>Phishing URL Detector</h1>
      <p class="sub">Rule-based risk scoring ‚Ä¢ explainable results ‚Ä¢ security-first</p>
    </header>

    <main class="card">
      <h2 class="section-title">Analyze a URL</h2>
      <p class="section-hint">
        Paste any link. The system will score the risk and show the reasons.
      </p>

      <label class="label" for="urlInput">Website URL</label>
      <div class="row">
        <input
          id="urlInput"
          class="input"
          type="text"
          placeholder="Examples: example.com, https://bank-secure-login.com, http://192.168.1.10/verify"
        />
        <button id="analyzeBtn" class="btn">
          <span class="btn-dot"></span>
          Analyze
        </button>
      </div>

      <div id="output" class="output hidden">
        <div class="topline">
          <div class="scorebox">
            <div class="scorelabel">Risk Score</div>
            <div class="scoreline">
              <div class="score" id="score">0</div>
              <div class="scoremax">/100</div>
            </div>
            <div class="scorebar">
              <div class="scorefill" id="scoreFill" style="width:0%"></div>
            </div>
          </div>

          <div class="verdictbox">
            <div class="verdict" id="verdict">‚Äî</div>
            <div class="meta">
              <div><span class="muted">Domain:</span> <span id="domain">‚Äî</span></div>
              <div><span class="muted">Path / Query:</span> <span id="pathquery">‚Äî</span></div>
            </div>
          </div>
        </div>

        <div class="flags">
          <div class="flags-title">Flags</div>
          <div id="flagsList" class="pillwrap"></div>
        </div>

        <div class="why">
          <h3>Why this score?</h3>
          <ul id="reasons" class="reasons"></ul>
        </div>

        <div class="tip">
          <div class="tip-title">Safety tip</div>
          <div class="tip-text">
            Don‚Äôt enter passwords on links you got from unknown messages. Always verify the domain carefully.
          </div>
        </div>
      </div>

      <hr class="sep" />

      <section class="how">
        <h3>How it works</h3>
        <p>
          This project uses explainable, rule-based checks commonly seen in phishing detection.
        </p>
        <ul class="bullets">
          <li>‚úÖ HTTPS check</li>
          <li>‚úÖ IP-based URL detection</li>
          <li>‚úÖ Suspicious keyword scan</li>
          <li>‚úÖ Punycode / lookalike detection</li>
          <li>‚úÖ Shortener & structure checks</li>
        </ul>
        <p class="small muted">
          Educational tool. For real-world systems, combine multiple signals (reputation, WHOIS, DNS, ML).
        </p>
      </section>
    </main>

    <footer class="foot">
      <span>Professional UI demo ‚Ä¢ No data is sent anywhere</span>
    </footer>
  </div>

  <script>
    const urlInput = document.getElementById("urlInput");
    const analyzeBtn = document.getElementById("analyzeBtn");
    const output = document.getElementById("output");
    const scoreEl = document.getElementById("score");
    const scoreFill = document.getElementById("scoreFill");
    const verdictEl = document.getElementById("verdict");
    const domainEl = document.getElementById("domain");
    const pathqEl = document.getElementById("pathquery");
    const flagsList = document.getElementById("flagsList");
    const reasonsEl = document.getElementById("reasons");

    const shorteners = [
      "bit.ly","tinyurl.com","t.co","goo.gl","is.gd","cutt.ly","ow.ly","buff.ly","rebrand.ly"
    ];

    const suspiciousWords = [
      "login","signin","verify","verification","update","secure","account","bank","billing",
      "password","confirm","wallet","support","unlock","urgent","limited","free","bonus"
    ];

    function normalize(u) {
      let s = (u || "").trim();
      if (!s) return "";
      if (!/^https?:\/\//i.test(s)) s = "http://" + s;
      return s;
    }

    function isIPAddress(host) {
      return /^(\d{1,3}\.){3}\d{1,3}$/.test(host);
    }

    function countChar(str, ch) {
      return (str.match(new RegExp("\\" + ch, "g")) || []).length;
    }

    function analyze(urlRaw) {
      const reasons = [];
      const flags = [];
      let score = 0;

      const normalized = normalize(urlRaw);

      let url;
      try {
        url = new URL(normalized);
      } catch {
        return {
          ok: false,
          score: 100,
          verdict: "Dangerous",
          domain: "‚Äî",
          pathquery: "‚Äî",
          flags: ["Invalid URL"],
          reasons: ["The input is not a valid URL. Try: https://example.com"]
        };
      }

      const host = url.hostname;
      const full = url.href;
      const pathquery = (url.pathname || "/") + (url.search || "");

      // HTTPS check
      if (url.protocol === "http:") {
        score += 12;
        flags.push("Not HTTPS");
        reasons.push("Uses HTTP instead of HTTPS. HTTPS is expected for logins and sensitive pages.");
      } else {
        reasons.push("Uses HTTPS (good sign).");
      }

      // IP-based URL
      if (isIPAddress(host)) {
        score += 30;
        flags.push("IP Address URL");
        reasons.push("Uses an IP address instead of a domain. Phishing often hides behind IPs.");
      }

      // @ symbol
      if (full.includes("@")) {
        score += 25;
        flags.push("Contains '@'");
        reasons.push("Contains '@' which can mislead users about the real destination domain.");
      }

      // Very long URL
      if (full.length > 90) {
        score += 15;
        flags.push("Very long URL");
        reasons.push("Very long URLs can hide suspicious parameters or redirect paths.");
      } else if (full.length > 70) {
        score += 8;
        flags.push("Long URL");
        reasons.push("Long URLs can be used to hide misleading paths or parameters.");
      }

      // Too many subdomains
      const dotCount = countChar(host, ".");
      if (dotCount >= 3) {
        score += 12;
        flags.push("Many subdomains");
        reasons.push("Many subdomains can be used to mimic real brands (e.g., secure.login.bank.example.com).");
      }

      // Hyphen in domain
      if (host.includes("-")) {
        score += 6;
        flags.push("Hyphenated domain");
        reasons.push("Hyphenated domains are sometimes used to imitate brands (lookalike domains).");
      }

      // Punycode
      if (host.startsWith("xn--")) {
        score += 18;
        flags.push("Punycode domain");
        reasons.push("Domain uses punycode (xn--), which can hide lookalike characters.");
      }

      // Shortener
      if (shorteners.includes(host.toLowerCase())) {
        score += 18;
        flags.push("URL shortener");
        reasons.push("URL shorteners hide the final destination domain.");
      }

      // Suspicious keywords
      const lower = full.toLowerCase();
      const hitWords = suspiciousWords.filter(w => lower.includes(w));
      if (hitWords.length) {
        const add = Math.min(20, 4 * hitWords.length);
        score += add;
        flags.push("Suspicious keywords");
        reasons.push("Contains suspicious keywords: " + hitWords.join(", ") + ".");
      }

      // Redirect indicators
      if (lower.includes("redirect") || lower.includes("url=") || lower.includes("next=")) {
        score += 10;
        flags.push("Redirect parameters");
        reasons.push("Contains redirect-like parameters (url= / next=) that can send users elsewhere.");
      }

      // Clamp 0-100
      score = Math.max(0, Math.min(100, score));

      let verdict = "Safe";
      if (score >= 70) verdict = "Dangerous";
      else if (score >= 35) verdict = "Suspicious";

      if (!flags.length) flags.push("None");

      return {
        ok: true,
        score,
        verdict,
        domain: host || "‚Äî",
        pathquery: pathquery || "/",
        flags,
        reasons
      };
    }

    function setVerdictStyle(verdict) {
      verdictEl.classList.remove("safe","warn","danger");

      if (verdict === "Safe") verdictEl.classList.add("safe");
      else if (verdict === "Suspicious") verdictEl.classList.add("warn");
      else verdictEl.classList.add("danger");

      verdictEl.textContent =
        verdict === "Safe" ? "‚úÖ Safe" :
        verdict === "Suspicious" ? "‚ö†Ô∏è Suspicious" :
        "‚õî Dangerous";
    }

    function setScoreBar(score) {
      scoreFill.style.width = score + "%";
      scoreFill.classList.remove("safe","warn","danger");
      if (score < 35) scoreFill.classList.add("safe");
      else if (score < 70) scoreFill.classList.add("warn");
      else scoreFill.classList.add("danger");
    }

    function render(res) {
      output.classList.remove("hidden");
      scoreEl.textContent = res.score;
      setScoreBar(res.score);
      setVerdictStyle(res.verdict);
      domainEl.textContent = res.domain;
      pathqEl.textContent = res.pathquery;

      flagsList.innerHTML = "";
      res.flags.forEach(f => {
        const span = document.createElement("span");
        span.className = "pill";
        span.textContent = f;
        flagsList.appendChild(span);
      });

      reasonsEl.innerHTML = "";
      res.reasons.forEach(r => {
        const li = document.createElement("li");
        li.textContent = r;
        reasonsEl.appendChild(li);
      });
    }

    function run() {
      const res = analyze(urlInput.value);
      render(res);
    }

    analyzeBtn.addEventListener("click", run);
    urlInput.addEventListener("keydown", (e) => {
      if (e.key === "Enter") run();
    });
  </script>
</body>
</html>